<app-navbar></app-navbar>

<div class="profile-container" *ngIf="userInfo">
  <h2>ğŸ‘¤ Profil utilisateur</h2>

  <div class="profile-grid">
    <div class="form-group">
      <label>ğŸ‘¨ Nom :</label>
      <input type="text" [(ngModel)]="userInfo.name" [readonly]="!editionActive">
    </div>

    <div class="form-group">
      <label>ğŸ“§ Email :</label>
      <input type="email" [(ngModel)]="userInfo.email" [readonly]="!editionActive">
    </div>

    <div class="form-group">
      <label>ğŸ›¡ï¸ RÃ´le :</label>
      <input type="text" [value]="userInfo.role.name" readonly>
    </div>

    <div class="form-group">
      <label>âœ… Status :</label>
      <input type="text" [value]="userInfo.status" readonly>
    </div>

    <div class="form-group">
      <label>ğŸ¢ Service :</label>
      <input type="text" [value]="userInfo.service.nomService" readonly>
    </div>

    <div class="form-group">
      <label>ğŸ›ï¸ MinistÃ¨re :</label>
      <input type="text" [value]="userInfo.service.ministere.nomMinistere || 'N/A'" readonly>
    </div>

    <div class="form-group">
      <label>ğŸ§© Produit :</label>
      <input type="text" [value]="userInfo.produit.nom" readonly>
    </div>
  </div>

  <div class="button-row">
    <button (click)="editionActive = !editionActive">
      {{ editionActive ? 'âŒ Annuler' : 'âœï¸ Modifier Nom & Email' }}
    </button>
    <button *ngIf="editionActive" (click)="enregistrerModifications()">ğŸ’¾ Enregistrer</button>
    <button (click)="ouvrirPopupMotDePasse()">ğŸ”’ Changer mot de passe</button>
    <button (click)="retour()">ğŸ”™ Retour</button>
  </div>

  <!-- POPUP mot de passe -->
  <div class="popup-overlay" *ngIf="popupVisible">
    <div class="popup-content">
      <h3>ğŸ”‘ Changer mot de passe</h3>

      <form (ngSubmit)="changerMotDePasse()">
        <div class="form-group">
          <label>ğŸ”“ Ancien mot de passe :</label>
          <input type="password" [(ngModel)]="ancienMotDePasse" name="ancienMotDePasse" required>
        </div>

        <div class="form-group">
          <label>ğŸ†• Nouveau mot de passe :</label>
          <input type="password" [(ngModel)]="nouveauMotDePasse" name="nouveauMotDePasse" required>
        </div>

        <div class="form-group">
          <label>âœ… Confirmer mot de passe :</label>
          <input type="password" [(ngModel)]="confirmationMotDePasse" name="confirmationMotDePasse" required>
        </div>

        <div class="button-row">
          <button type="submit">âœ… Valider</button>
          <button type="button" (click)="popupVisible = false">âŒ Fermer</button>
        </div>
      </form>
    </div>
  </div>
</div>